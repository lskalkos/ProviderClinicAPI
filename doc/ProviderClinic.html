<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: ProviderClinic
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "ProviderClinic";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (P)</a> &raquo;
    
    
    <span class="title">ProviderClinic</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: ProviderClinic
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ActiveRecord::Base</li>
          
            <li class="next"><span class='object_link'><a href="ApplicationRecord.html" title="ApplicationRecord (class)">ApplicationRecord</a></span></li>
          
            <li class="next">ProviderClinic</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/provider_clinic.rb</dd>
  </dl>
  
</div>


  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="UPPER_TIERS-constant" class="">UPPER_TIERS =
          
        </dt>
        <dd><pre class="code"><span class='qsymbols_beg'>%i{</span><span class='tstring_content'>A</span><span class='words_sep'> </span><span class='tstring_content'>B</span><span class='words_sep'> </span><span class='tstring_content'>C</span><span class='tstring_end'>}</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#by_tier_and_distance-class_method" title="by_tier_and_distance (class method)">.<strong>by_tier_and_distance</strong>(zipcodes_by_distance = {})  &#x21d2; Array&lt;ProviderClinic&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Queries for provider clinics in a set of given zipcodes, and then sorts
those clinics by their tier first and then the distance of that zipcode.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="by_tier_and_distance-class_method">
  
    .<strong>by_tier_and_distance</strong>(zipcodes_by_distance = {})  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="" title="ProviderClinic (class)">ProviderClinic</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Queries for provider clinics in a set of given zipcodes, and then sorts
those clinics by their tier first and then the distance of that zipcode. If
two clinics are in the same tier, it orders the closest one first. TEST</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>zipcodes_by_distance</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a dictionary of zipcodes and their distance in decimals</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="ProviderClinic (class)">ProviderClinic</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/provider_clinic.rb', line 18</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_by_tier_and_distance'>by_tier_and_distance</span><span class='lparen'>(</span><span class='id identifier rubyid_zipcodes_by_distance'>zipcodes_by_distance</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Please provide a hash of zipcodes and their distances from a location</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_zipcodes_by_distance'>zipcodes_by_distance</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='id identifier rubyid_nearby_zipcodes'>nearby_zipcodes</span> <span class='op'>=</span> <span class='id identifier rubyid_zipcodes_by_distance'>zipcodes_by_distance</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
  <span class='id identifier rubyid_nearby_clinics'>nearby_clinics</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_upper_tiers'>upper_tiers</span><span class='period'>.</span><span class='id identifier rubyid_in_zipcodes'>in_zipcodes</span><span class='lparen'>(</span><span class='id identifier rubyid_nearby_zipcodes'>nearby_zipcodes</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_clinics_by_distance'>clinics_by_distance</span> <span class='op'>=</span> <span class='id identifier rubyid_nearby_clinics'>nearby_clinics</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_clinic'>clinic</span><span class='op'>|</span>
    <span class='lbrace'>{</span>
      <span class='label'>clinic:</span> <span class='id identifier rubyid_clinic'>clinic</span><span class='comma'>,</span>
      <span class='label'>zipcode:</span> <span class='id identifier rubyid_clinic'>clinic</span><span class='period'>.</span><span class='id identifier rubyid_zipcode'>zipcode</span><span class='comma'>,</span>
      <span class='label'>distance:</span> <span class='id identifier rubyid_zipcodes_by_distance'>zipcodes_by_distance</span><span class='lbracket'>[</span><span class='id identifier rubyid_clinic'>clinic</span><span class='period'>.</span><span class='id identifier rubyid_zipcode'>zipcode</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>tier:</span> <span class='id identifier rubyid_clinic'>clinic</span><span class='period'>.</span><span class='id identifier rubyid_tier'>tier</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='comment'># Try to name variables as semantically as possible to help future
</span>  <span class='comment'># developers understand what the code is doing. Also use the wonderful
</span>  <span class='comment'># built-in Enumerable methods Ruby gives us to write the sort more
</span>  <span class='comment'># cleanly instead of using the confusing nested `while`.
</span>  <span class='comment'># Make use of .map instead of mutation arrays and hashes in place. I would definitely leave a comment here:
</span>  <span class='comment'># Sort clinics by tier first and then distance. If two clinics are in the same tier,
</span>  <span class='comment'># order the closest one first.
</span>  <span class='id identifier rubyid_clinics_by_distance'>clinics_by_distance</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='symbol'>:tier</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='symbol'>:distance</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='lbracket'>[</span><span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='symbol'>:tier</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='symbol'>:distance</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span> <span class='id identifier rubyid_d'>d</span><span class='lbracket'>[</span><span class='symbol'>:clinic</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sun Oct  3 11:12:14 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.5.1).
</div>

    </div>
  </body>
</html>